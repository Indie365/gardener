rule_files:
- seed.prometheusrule.yaml

tests:
  - name: SeedExtensionsNotReady:SmoothOutFlapping
    interval: 1m
    input_series:
      - series: garden_seed_condition{condition = "ExtensionsReady",
                                      name      = "seed-flapping"}
        values: 0x2 2 0 -1 2 0x2 2 0
      - series: garden_seed_condition{condition = "ExtensionsReady",
                                      name      = "seed-progressing-for-long"}
        values: 2x2 0x8
    external_labels:
      landscape: landscape-unit-tests
    alert_rule_test:
      - alertname: SeedExtensionsNotReady
        eval_time: 10m
        exp_alerts:
          - exp_labels:
              severity: critical
              topology: seed
              condition: ExtensionsReady
              name: seed-flapping
            exp_annotations:
              summary: >-
                A seed has a failing ExtensionsReady condition in
                landscape landscape-unit-tests
              description: >
                The seed cluster: seed-flapping has condition ExtensionsReady in
                failing/unknown state. Some seed extensions may have an issue.
