apiVersion: skaffold/v4beta7
kind: Config
metadata:
  name: garden
manifests:
  rawYaml:
    - example/operator/20-garden.yaml
deploy:
  statusCheck: false # enabled status check would watch all deployments in the garden namespace
  kubectl:
    hooks:
      after:
        - host:
            command:
              - bash
              - -ec
              - hack/usage/wait-for.sh garden local VirtualGardenAPIServerAvailable VirtualComponentsHealthy
        - host:
            command:
              - bash
              - -ec
              - kubectl -n garden get secret gardener -o jsonpath={.data.kubeconfig} | base64 -d > $VIRTUAL_GARDEN_KUBECONFIG
---
apiVersion: skaffold/v4beta7
kind: Config
metadata:
  name: garden-config
manifests:
  rawYaml:
    - example/00-namespace-garden.yaml
    - example/gardener-local/controlplane/domain-secrets.yaml
    - example/provider-local/garden/base/cloudprofile.yaml
    - example/provider-local/garden/base/project.yaml
    - example/provider-local/garden/base/secretbinding.yaml
    - example/provider-local/garden/base/secret-backup.yaml
    - example/gardener-local/gardenlet/secret-bootstrap-token.yaml
    - https://raw.githubusercontent.com/gardener/gardener-extension-networking-cilium/v1.36.0/example/controller-registration.yaml
    - https://raw.githubusercontent.com/gardener/gardener-extension-networking-calico/v1.40.0/example/controller-registration.yaml
deploy:
  kubectl: {}
