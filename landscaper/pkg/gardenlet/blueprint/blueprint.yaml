# this blueprint is generated, please do not modify manually
apiVersion: landscaper.gardener.cloud/v1alpha1
kind: Blueprint
# JSONSchema generated by kube-openapi in version draft-04
# For reference, see: https://json-schema.org/specification-links.html#draft-4
jsonSchema: "http://json-schema.org/draft-04/schema"
imports:
  
  - name: apiVersion
    required: false
    schema:
      description: 'APIVersion defines the versioned schema of this representation of
        an object. Servers should convert recognized schemas to the latest internal
        value, and may reject unrecognized values. More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#resources'
      type: string
  - name: componentConfiguration
    required: true
    schema:
      ref: blueprint://schema/io.k8s.apimachinery.pkg.runtime.RawExtension.yaml
  - name: componentImageVectorOverwrites
    required: false
    schema:
      description: ComponentImageVectorOverwrites contains an optional image vector
        override for components deployed by the gardenlet.
      type: string
  - name: deploymentConfiguration
    required: false
    schema:
      ref: blueprint://schema/com.github.gardener.gardener.pkg.apis.seedmanagement.v1alpha1.GardenletDeployment.yaml
  - name: gardenCluster
    required: true
    targetType: landscaper.gardener.cloud/kubernetes-cluster
  - name: imageVectorOverwrite
    required: false
    schema:
      description: ImageVectorOverwrite contains an optional image vector override.
      type: string
  - name: seedBackupCredentials
    required: false
    schema:
      description: SeedBackupCredentials contains the credentials for an optional backup
        provider for the Seed cluster registered by the Gardenlet required when the
        Seed is configured for Backup (configured in the Gardenlet component configuration
        in the field seedConfig.spec.backup). Before deploying the Gardenlet, the landscaper
        deploys a secret containing the specified credentials into the Garden cluster
      type: string
  - name: seedCluster
    required: true
    targetType: landscaper.gardener.cloud/kubernetes-cluster
  

# For what can be referenced in the deployExecutions, please see:
# https://github.com/gardener/landscaper/blob/master/docs/usage/Blueprints.md#deployexecutions
deployExecutions:
  - name: default
    type: GoTemplate
    template: |
      deployItems:
      - name: deploy
        type: landscaper.gardener.cloud/container
        target:
          name: {{ .imports.seedCluster.metadata.name }}
          namespace: {{ .imports.seedCluster.metadata.namespace }}
        config:
          apiVersion: container.deployer.landscaper.gardener.cloud/v1alpha1
          kind: ProviderConfiguration
          blueprint:
      {{ toYaml .blueprint | indent 6 }}

          componentDescriptor:
      {{ toYaml .componentDescriptorDef | indent 6 }}

          # the import configuration of the Landscaper Gardenlet
          importValues:
            {{ if .imports.apiVersion }}
            apiVersion: .imports.apiVersion
            {{else}}
            apiVersion: gardenlet.gardener.landscaper.gardener.cloud/v1alpha1
            {{end}}
            kind: Imports
      {{ toYaml .imports | indent 6 }}

          {{ $resource := getResource .cd "name" "landscaper-gardenlet" }}
          image: {{ $resource.access.imageReference }}

